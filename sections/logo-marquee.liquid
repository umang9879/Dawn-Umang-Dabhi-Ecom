{% comment %}
  Section: Logo Marquee (Swiper-based)
  - Auto-slide + loop
  - Centers slides if fewer than container width
{% endcomment %}

<!-- Swiper CSS -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
/>

<!-- Swiper JS -->
<script
  src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"
  defer
></script>

{% style %}
  #logo-marquee-{{ section.id }} {
    width: 100%;
    background-color: {{ section.settings.bg_color }};
    padding-block: {{ section.settings.padding_y | append: "px" }};
    overflow: hidden;
    position: relative;
  }

  #logo-marquee-{{ section.id }} .swiper {
    width: 100%;
  }

  #logo-marquee-{{ section.id }} .swiper-wrapper {
    display: flex;
    align-items: center;
  }

  #logo-marquee-{{ section.id }} .logo-item {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 96px;
    width: fit-content;
  }

  #logo-marquee-{{ section.id }} .logo-item img {
    height: 96px;
    width: 178px;
    object-fit: contain;
    user-select: none;
    -webkit-user-drag: none;
  }
{% endstyle %}

<section id="logo-marquee-{{ section.id }}" class="logo-marquee-section">
  <div class="swiper logo-marquee-swiper-{{ section.id }}">
    <div class="swiper-wrapper">
      {% for block in section.blocks %}
        {% if block.settings.image != blank %}
          <div class="swiper-slide logo-item">
            <img
              src="{{ block.settings.image | image_url: width: 178 }}"
              alt="{{ block.settings.image.alt | escape }}"
              loading="lazy"
              height="96"
              width="auto"
            >
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const swiperEl = document.querySelector(
        "#logo-marquee-{{ section.id }} .swiper"
      );

      if (swiperEl) {
        new Swiper(swiperEl, {
          slidesPerView: "auto",
          spaceBetween: {{ section.settings.blocks_gap }},
          loop: true,
          centeredSlides: true,
          centerInsufficientSlides: true,
          speed: 3000,
          allowTouchMove: false,
          autoplay: {
            delay: 0,
            disableOnInteraction: false,
          },
          freeMode: {
            enabled: true,
            momentum: false,
          },
        });
      }
    });
  </script>
</section>

{% schema %}
{
  "name": "Logo Marquee (Swiper)",
  "settings": [
    {
      "type": "color",
      "label": "Background Color",
      "id": "bg_color",
      "default": "#F5F5F5"
    },
    {
      "type": "range",
      "label": "Padding Y",
      "id": "padding_y",
      "min": 0,
      "max": 100,
      "unit": "px",
      "default": 72
    },
    {
      "type": "range",
      "label": "Gap Between Logos",
      "id": "blocks_gap",
      "min": 0,
      "max": 100,
      "unit": "px",
      "default": 32
    }
  ],
  "blocks": [
    {
      "type": "logo",
      "name": "Logo Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Logo image"
        }
      ]
    }
  ],
  "max_blocks": 20,
  "presets": [
    {
      "name": "Logo Marquee Swiper",
      "category": "Image"
    }
  ]
}
{% endschema %}
